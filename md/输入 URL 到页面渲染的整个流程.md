# 输入 URL 到页面渲染的整个流程
1. DNS查询（**DNS 是基于 UDP 做的查询**）
	1. 操作系统会首先在本地缓存中查询 IP
	2. 没有的话会去系统配置的 DNS 服务器中查询
	3. 如果这时候还没得话，会直接去 DNS 根服务器查询，这一步查询会找出负责 `com` 这个一级域名的服务器
	4. 然后去该服务器查询二级域名
	5. 接下来三级域名的查询其实是我们配置的，你可以给 `www` 这个域名配置一个 IP，然后还可以给别的三级域名配置一个 IP
2. 建立TCP链接
	1. TCP 三次握手
	2. 是 https 协议还会触发TLS 四次握手
3. 客户端发送请求
4. 服务端会响应一个 HTML 文件
5. 浏览器会判断状态码是什么，如果是 200 那就继续解析，如果 400 或 500 的话就会报错，如果 300 的话会进行重定向
6. 浏览器开始解析文件，如果是 gzip 格式的话会先解压一下，然后通过文件的编码格式知道该如何去解码文件。
7. 文件解码成功后会正式开始渲染流程，先会根据 HTML 构建 DOM 树，有 CSS 的话会去构建 CSSOM 树。如果遇到 script 标签的话，会判断是否存在 async 或者 defer ，前者会并行进行下载并执行 JS，后者会先下载文件，然后等待 HTML 解析完成后顺序执行。如果以上都没有，就会阻塞住渲染流程直到 JS 执行完毕。
8. 遇到文件下载的会去下载文件
9. CSSOM 树和 DOM 树构建完成后会开始生成 Render 树，这一步就是确定页面元素的布局、样式等等
10. 生成 Render树的过程中，浏览器开始调用 GPU 绘制，合成图层，将内容显示在屏幕上

## DNS查询
![img](https://mmbiz.qpic.cn/sz_mmbiz_jpg/2wV7LicL762ZUCR5WEela9H9fDfYic8BApD65Q8HIKGS2KbZnZfFMYtZ0R9iaLY9gFkicHsibON2CmEh8ib2LCIEL1nw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

## 建立TCP链接
### TCP三次握手
1. 第一次握手：建立连接。客户端发送连接请求报文
2. 第二次握手：服务器收到SYN报文段
3. 第三次握手：客户端收到服务器的SYN+ACK报文段。

### TSL四次握手
1. 第一阶段 建立安全能力 包括协议版本 会话Id 密码构件 压缩方法和初始随机数
2. 第二阶段 服务器发送证书 密钥交换数据和证书请求，最后发送请求-相应阶段的结束信号
3. 第三阶段 如果有证书请求客户端发送此证书 之后客户端发送密钥交换数据 也可以发送证书验证消息
4. 第四阶段 变更密码构件和结束握手协议

### TCP四次分手
